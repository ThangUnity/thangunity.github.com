<!DOCTYPE HTML>
<html>

<head>
    <meta charset="UTF-8">
    <meta name="robots" content="noindex">
    <meta name="viewport" id="viewport"
        content="user-scalable=no, initial-scale=1.0, width=device-width, minimum-scale=1.0, maximum-scale=1.0" />
    <link rel="Stylesheet" href="include/bootstrap-reboot.min.css" type="text/css" />
    <meta name="theme-color" content="#fafafa" />
    <title>Volkswagen</title>
    <link rel="Stylesheet" href="style.css" type="text/css" />
   <script type="text/javascript" src="https://static.sketchfab.com/api/sketchfab-viewer-1.12.0.js"></script>
    <script type="text/javascript" src="include/jquery-1.12.0.min.js"></script>
</head>

<body >
    <div class="iframe-gradient"></div>
    <div class="iframe-mask" id="iframe-mask"></div>
    <div class="iframe-loader" id="iframe-loader">loading 0%...<div></div>
    </div>
    <div class="iframe-container">
        <!-- Insert an empty iframe, hidden by default using a class-->
        <iframe src="" id="api-frame" allow="autoplay; fullscreen; vr" allowvr allowfullscreen mozallowfullscreen="true"
            webkitallowfullscreen="true"></iframe>
    </div>

    <div class="top">
        <div class="navigation">
            <div class="navigation__left">
                <!-- <svg class="rings" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 283.46 98.08">
                    <path
                        d="M234.43,0a48.77,48.77,0,0,0-30.9,11,49,49,0,0,0-61.8,0,49,49,0,0,0-61.79,0,49,49,0,1,0,0,76.14,49,49,0,0,0,61.79,0,49,49,0,0,0,61.8,0A49,49,0,1,0,234.43,0Zm-30.9,71.08a37.89,37.89,0,0,1,0-44.08,37.93,37.93,0,0,1,0,44.08Zm-61.8,0a37.93,37.93,0,0,1,0-44.08,37.93,37.93,0,0,1,0,44.08Zm-61.79,0a37.89,37.89,0,0,1,0-44.08,37.93,37.93,0,0,1,0,44.08ZM11.08,49A37.95,37.95,0,0,1,72.14,18.93a49,49,0,0,0,0,60.22A37.95,37.95,0,0,1,11.08,49ZM87.73,79.15a49,49,0,0,0,0-60.22,37.93,37.93,0,0,1,46.21,0,49,49,0,0,0,0,60.22,37.93,37.93,0,0,1-46.21,0Zm61.8,0a49,49,0,0,0,0-60.22,37.91,37.91,0,0,1,46.2,0,49,49,0,0,0,0,60.22,37.91,37.91,0,0,1-46.2,0ZM234.43,87a37.78,37.78,0,0,1-23.11-7.85,49,49,0,0,0,0-60.22A38,38,0,1,1,234.43,87Z" />
                </svg> -->
                <svg class="rings" viewBox="0 0 283.46 98.08" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <title>Volkswagen Logo</title>
                    <path fill-rule="evenodd" clip-rule="evenodd"
                        d="M48 24C48 37.2857 37.2857 48 24 48C10.7143 48 0 37.2857 0 24C0 10.7143 10.7143 0 24 0C37.2857 0 48 10.7143 48 24ZM23.8095 18.3619C23.8476 18.4381 23.8857 18.5143 24 18.5143C24.1143 18.5143 24.1524 18.4381 24.1905 18.3619C24.2095 18.3238 24.2286 18.2857 24.2571 18.2571L30.8571 4.02857C28.7143 3.25714 26.4 2.82857 24 2.82857C21.6 2.82857 19.2857 3.25714 17.1429 4.02857L23.7429 18.2571C23.7714 18.2857 23.7905 18.3238 23.8095 18.3619ZM2.91429 24C2.91429 35.5714 12.4286 45.1714 24 45.1714C35.5714 45.1714 45.0857 35.5714 45.1714 24C45.1714 21.5143 44.7429 19.2 43.9714 17.0571L31.6286 41.0571C31.4571 41.4 31.2857 41.6571 30.8571 41.6571C30.4286 41.6571 30.2571 41.4 30.0857 41.0571L24.2571 28.2857C24.2286 28.2571 24.2095 28.219 24.1905 28.181C24.1524 28.1048 24.1143 28.0286 24 28.0286C23.9143 28.0286 23.8286 28.1143 23.7429 28.2857L18 41.0571C17.8286 41.4 17.6571 41.6571 17.2286 41.6571C16.8 41.6571 16.6286 41.4 16.4571 41.0571L4.11429 17.0571C3.34286 19.2857 2.91429 21.6 2.91429 24ZM17.0571 33.9429C16.9429 33.9429 16.9048 33.8667 16.8667 33.7905L16.8666 33.7904C16.8476 33.7524 16.8286 33.7143 16.8 33.6857L6 12.9429C7.88571 9.85714 10.6286 7.28571 13.8 5.48571L21.4286 21.9429C21.6 22.2857 21.7714 22.3714 22.0286 22.3714H25.9714C26.2286 22.3714 26.4 22.2857 26.5714 21.9429L34.1143 5.48571C37.2857 7.28571 40.0286 9.85714 41.9143 12.9429L31.2 33.6857C31.1143 33.8571 31.0286 33.9429 30.9429 33.9429C30.8286 33.9429 30.7905 33.8667 30.7524 33.7905C30.7333 33.7524 30.7143 33.7143 30.6857 33.6857L26.5714 24.6C26.4 24.2571 26.2286 24.1714 25.9714 24.1714H22.0286C21.7714 24.1714 21.6 24.2571 21.4286 24.6L17.3143 33.6857C17.2857 33.7143 17.2667 33.7524 17.2476 33.7905C17.2095 33.8667 17.1714 33.9429 17.0571 33.9429Z"
                        fill="white" />
                </svg>

            </div>
            <div class="navigation__right" style="display: none;">
                <svg viewBox="0 0 48 48" version="1.1" xmlns="http://www.w3.org/2000/svg">
                    <title>
                        dashboard-large
                    </title>
                    <path
                        d="M3.5,3.5 L12.5,3.5 L12.5,12.5 L3.5,12.5 L3.5,3.5 Z M19.5,3.5 L28.5,3.5 L28.5,12.5 L19.5,12.5 L19.5,3.5 Z M35.5,3.5 L44.5,3.5 L44.5,12.5 L35.5,12.5 L35.5,3.5 Z M3.5,19.5 L12.5,19.5 L12.5,28.5 L3.5,28.5 L3.5,19.5 Z M19.5,19.5 L28.5,19.5 L28.5,28.5 L19.5,28.5 L19.5,19.5 Z M35.5,19.5 L44.5,19.5 L44.5,28.5 L35.5,28.5 L35.5,19.5 Z M3.5,35.5 L12.5,35.5 L12.5,44.5 L3.5,44.5 L3.5,35.5 Z M19.5,35.5 L28.5,35.5 L28.5,44.5 L19.5,44.5 L19.5,35.5 Z M35.5,35.5 L44.5,35.5 L44.5,44.5 L35.5,44.5 L35.5,35.5 Z"
                        stroke-width="1" fill="none" fill-rule="evenodd" />
                </svg>
            </div>
        </div>
    </div>

<div id="top-right" class="text-right">
    <div class="selector-box">
        <span style="font-weight: bold; font-size: 50px;" class="car-name active">Teramont</span>
        <span style="font-weight: 300; font-size: 30px;" class="car-name active">Đỉnh cao chủ động</span>
        <span style="font-weight: 300; font-size: 16px;" class="descr small">
Một chiếc xe 7 chỗ cho gia đình và công việc.
Một chiếc xe SUV lớn cho tất cả những cuộc phiêu lưu và khám phá.</span>
    </div>
    <div class="selector-box">
        <span style="cursor: pointer; font-size: 24px; font-weight: bold;" class="car-feature" id="colors">Ngoại
thất</span>

    </div>
    <div class="selector-box">
        <span style="cursor: pointer; font-size: 24px; font-weight: bold;" class="car-feature" id="intColors">Nội
thất</span>

    </div>
</div>
    <div class="views" id="cameraPicker">
        <div>
            <svg width="48" height="48" viewBox="0 0 48 48" version="1.1" xmlns="http://www.w3.org/2000/svg"
                class="camera" data-cam-id="0">
                <title>
                    car-large
                </title>
                <path
                    d="M2.5,23 L2.5,37 C2.5,37.8284271 3.17157288,38.5 4,38.5 L9,38.5 C9.82842712,38.5 10.5,37.8284271 10.5,37 L10.5,35.5 L37.5,35.5 L37.5,37 C37.5,37.8284271 38.1715729,38.5 39,38.5 L44,38.5 C44.8284271,38.5 45.5,37.8284271 45.5,37 L45.5,23 L41,18.5 C40.0666656,16.6666667 39.2333323,15.1666667 38.5,14 C37.7666677,12.8333333 36.7666677,11.5 35.5,10 C31.7608696,9.66666667 27.9347826,9.5 24.0217391,9.5 C20.1086957,9.5 16.2681159,9.66666667 12.5,10 C11.2333336,11.5 10.2333336,12.8333333 9.5,14 C8.76666641,15.1666667 7.93333308,16.6666667 7,18.5 L2.5,23 Z M15,27 L17,24.5 L31,24.5 L33,27 C31.6666667,30.6666667 30.6666667,32.5 30,32.5 C29,32.5 19,32.5 18,32.5 C17.3333333,32.5 16.3333333,30.6666667 15,27 Z M6.75,18.5 L24,18.5 L41.25,18.5 M43.5,23.5749239 C43.5,24.5459384 43.4166667,25.2053587 43.25,25.5531847 C43,26.0749239 42.5,26.5749239 42,26.5749239 L40,26.5749239 C39.5,26.5749239 35.75,25.5749239 35.25,25.0749239 C34.9166667,24.7415905 34.6666667,24.4082572 34.5,24.0749239 C36.2683726,23.841489 37.7683726,23.6748224 39,23.5749239 C40.2316274,23.4750254 41.7316274,23.4750254 43.5,23.5749239 Z M4.5,23.5749239 C6.26837257,23.4750254 7.76837257,23.4750254 9,23.5749239 C10.2316274,23.6748224 11.7316274,23.841489 13.5,24.0749239 C13.3333333,24.4082572 13.0833333,24.7415905 12.75,25.0749239 C12.25,25.5749239 8.5,26.5749239 8,26.5749239 C7.5,26.5749239 6.5,26.5749239 6,26.5749239 C5.5,26.5749239 5,26.0749239 4.75,25.5531847 C4.58333333,25.2053587 4.5,24.5459384 4.5,23.5749239 Z"
                    stroke-width="1" fill="none" fill-rule="evenodd" />
            </svg>
        </div>
        <div>
            <svg width="48" height="48" viewBox="0 0 48 48" version="1.1" xmlns="http://www.w3.org/2000/svg"
                class="camera" data-cam-id="1">
                <title>
                    test-drive-large
                </title>
                <path
                    d="M23.5,44.5 C34.545695,44.5 43.5,35.545695 43.5,24.5 C43.5,13.454305 34.545695,4.5 23.5,4.5 C12.454305,4.5 3.5,13.454305 3.5,24.5 C3.5,35.545695 12.454305,44.5 23.5,44.5 Z M23.5,41.5 C27.6881245,41.5 31.5225212,39.9855113 34.4854041,37.4743201 C38.1646435,34.3559808 40.5,29.7007162 40.5,24.5 C40.5,15.1111593 32.8888407,7.5 23.5,7.5 C14.1111593,7.5 6.5,15.1111593 6.5,24.5 C6.5,29.7118989 8.84541031,34.3759979 12.538348,37.494414 C15.4979577,39.9935882 19.3230582,41.5 23.5,41.5 Z M30.0766572,29.0766572 L36.5,35.5 L30.0766572,29.0766572 Z M28.0941322,32.0941322 L34,38 L28.0941322,32.0941322 Z M18.9111915,32.0888085 L13,38 M16.9416504,29.0624695 L10.5,35.5 M16.5,24.5 L6.5,24.5 M40.5,24.5 L30.5,24.5 M7.25431729,19.5 C7.25431729,19.5 10.8362115,19.5 18,19.5 M39.752308,19.5 L29,19.5 L39.752308,19.5 Z M23.5,33.5803114 C27.918278,33.5803114 30.5,30.5803114 30.5,26.0803114 C30.5,23.5803114 30.5,20.5803114 28.5,19.2803122 C26.8974467,18.2386532 20.0987283,18.2411394 18.5,19.2803122 C16.5,20.5803114 16.5,23.5803114 16.5,26.0803114 C16.5,30.5803114 19.081722,33.5803114 23.5,33.5803114 Z"
                    stroke-width="1" fill="none" fill-rule="evenodd" />
            </svg>
        </div>
        <div>
            <svg viewBox="0 0 48 48" version="1.1" xmlns="http://www.w3.org/2000/svg" class="camera" data-cam-id="2">
                <title>
                    interior-configuration-large
                </title>
                <path
                    d="M24.2,39 L29.1,45.3 L24.2,39 Z M4.5,43 L4.5,39 C4.5,39 4,34.4 9.2,34.4 C14.4,34.4 24.2,39 24.2,39 C24.2,33.2 31.2,10.7 40.2,15 C40.2,15 42,15.6 40.2,19 C38.4,22.4 30.2,45 30.2,45 C30.2,45 29.8,45.6 24.1,45.6 L4.5,43 Z M37.5,2.5 L40.5,2.5 C41.6,2.5 42.5,3.4 42.5,4.5 L42.5,9.5 C42.5,10.6 41.6,11.5 40.5,11.5 L37.5,11.5 C36.4,11.5 35.5,10.6 35.5,9.5 L35.5,4.5 C35.5,3.4 36.4,2.5 37.5,2.5 Z"
                    stroke-width="1" fill="none" fill-rule="evenodd" />
            </svg>
        </div>
        <div>
            <svg width="48" height="48" viewBox="0 0 48 48" version="1.1" xmlns="http://www.w3.org/2000/svg"
                class="animation" id="openDoor">
                <title>door</title>
                <path d="M5.5,42.2V22C12.3,10.7,18.6,8.1,18.6,8.1s15.9-1.3,23.7,0v34.1C42.3,42.2,5.5,42.2,5.5,42.2z"
                    stroke-width="1" fill="none" fill-rule="evenodd" />
                <line x1="42.3" y1="22" x2="10.9" y2="22" stroke-width="1" fill="none" fill-rule="evenodd" />
                <path d="M32.7,24.9c3-0.9,5.9,0,5.9,0v1.6c-3,1.3-5.9,0-5.9,0V24.9z" stroke-width="1" fill="none"
                    fill-rule="evenodd" />
                <path d="M39,36.9l-20.6,0.4c-5.1,0-9.4,1.9-9.4,1.9" stroke-width="1" fill="none" fill-rule="evenodd" />
                <path d="M7.6,21l2-2.2c2.1-1.5,7.2-2,8.7-0.1c0,0,0.7,1.4,0,3.2h-7.4v1.8H7.6V21z" stroke-width="1"
                    fill="none" fill-rule="evenodd" />
                <line x1="7.6" y1="22" x2="5.5" y2="22" stroke-width="1" fill="none" fill-rule="evenodd" />
            </svg>
        </div>
    </div>

    <div class="colors" id="colorPicker">
        <span class="info"></span>
        <div class="car-color active" data-color-id="0" data-name="Màu xanh" data-price="0">
            <img src="images/paints/blue.png" alt="Blue">
        </div>
        <div class="car-color " data-color-id="1" data-name="Màu đỏ" data-price="0">
            <img src="images/paints/red.png" alt="Red">
        </div>
        <div class="car-color" data-color-id="2" data-name="Màu trắng" data-price="0">
            <img src="images/paints/white.png" alt="Black">
        </div>
        <div class="car-color" data-color-id="3" data-name="Màu đen" data-price="0">
            <img src="images/paints/black.png" alt="Green">
        </div>
        <div class="car-color" data-color-id="4" data-name="Màu xám" data-price="0">
            <img src="images/paints/grey.png" alt="Grey">
        </div>
    </div>

<div class="colors" id="colorPicker2">
<span class="info">Đen</span>
<div class="int-color active" data-color-id="0" data-name="Đen" data-price="0">
<img src="images/leathers/black_black.jpg" alt="black_black">
</div>
<div class="int-color" data-color-id="1" data-name="Nâu đen" data-price="0">
<img src="images/leathers/nougat_black.jpg" alt="nougat_black">
</div>

    <script type="text/javascript">
        let vh = window.innerHeight * 0.01;
        document.documentElement.style.setProperty('--vh', `${vh}px`);
        window.addEventListener('resize', () => {
            let vh = window.innerHeight * 0.01;
            document.documentElement.style.setProperty('--vh', `${vh}px`);
        });
        var iframe = document.getElementById('api-frame');
		
        var urlid = 'd06c2b8e332b4cc6925773c7d9891dda';
        // var urlid = '319b10ac40014466a12bda0c5333f69b';
        var client = null;
        var loadedApi = null;
        var paintMaterial = null;
        var leatherMaterial = null;
        var intMaterial1 = null;
        var intMaterial2 = null;
        var intMaterial3 = null;
        var intMaterial4 = null;
        var intMaterial5 = null;
        var intMaterial6 = null;
        var intMaterial7 = null;
        var currentCamera = 0;
        var cameraPosition = [-900, 40, 0];
        var cameraTarget = [-0.13, 12.57, 114.72];

        var cameraHeadPosition =  [32, 3.4, 111];
        var cameraHeadTarget = [33, -15, 105];

        var cameraHeadPosition2 = [-6, 81, 111];
        var cameraHeadTarget2 = [-6, 60, 110];

        var basePrice = 53250;
        var option1Price = 0;
        var option2Price = 0;
        var currentColorText = "";
        var currentIntText = "";

        var animationInt;
        var animationRunning = false;
        var doorOpened = false;

        var myMaterials;

        const GAMMA = 2.4;

        var colors = [
            '#1C4865',
            '#bc1515',
            '#f1f0f0',
            '#2b2724',
            '#635e67',
        ]
        var intColors = [
            '#050404',
            '#130707'
        ]

        function srgbToLinear1(c) {
            var v = 0.0;
            if (c < 0.04045) {
                if (c >= 0.0) v = c * (1.0 / 12.92);
            } else {
                v = Math.pow((c + 0.055) * (1.0 / 1.055), GAMMA);
            }
            return v;
        }

        function srgbToLinear(c, out) {
            var col = out || new Array(c.length);

            if (c.length > 2 && c.length < 5) {
                col[0] = srgbToLinear1(c[0]);
                col[1] = srgbToLinear1(c[1]);
                col[2] = srgbToLinear1(c[2]);
                if (col.length > 3 && c.length > 3) col[3] = c[3];
            } else {
                throw new Error('Invalid color. Expected 3 or 4 components, but got ' + c.length);
            }
            return col;
        }

        function hexToRgb(hexColor) {
            var m = hexColor.match(/^#([0-9a-f]{6})$/i);
            if (m) {
                return [
                    parseInt(m[1].substr(0, 2), 16) / 255,
                    parseInt(m[1].substr(2, 2), 16) / 255,
                    parseInt(m[1].substr(4, 2), 16) / 255
                ];
            } else {
                throw new Error('Invalid color: ' + hexColor);
            }
        }
		 var uiLight = [
            true, // blue
            true, // red
            false, // white
            true, // black
            true // grey
        ];
        var intensity = [
            1, // white
            1, // green
            0.5, // black
            1, // orange
            1 // grey
        ];
        var metalness = [
            0.85, // white
            0.85, // green
            1, // black
            0.6, // orange
            1 // grey
        ];

        function changeCarColor(index) {
            console.log('change car color index')
            console.log(index);
            var carColors = [
                "#E2EBF7", // white
                "#07273B", // green
                "#1F2125", // black
                "#8C450A", // orange
                "#383838"  // grey
            ];
            var bgColors = [
                "#FAFAFA", // white
                "#07273B", // green
                "#1F2125", // black
                "#DD7B00", // orange
                "#868686"  // grey
            ];
           

           
            

            if (paintMaterial == null || loadedApi == null) {
                console.log("Api not loaded yet or failed.");
                return;
            }
			paintMaterial.channels.AlbedoPBR.enable = true;
            paintMaterial.channels.AlbedoPBR.factor = 1;
            const linearColor = srgbToLinear(hexToRgb(colors[index]));
            paintMaterial.channels.AlbedoPBR.color = linearColor;
            paintMaterial.channels.AlbedoPBR.factor = intensity[index];
            paintMaterial.channels.MetalnessPBR.factor = metalness[index];
            loadedApi.setMaterial(paintMaterial, function () {
                $("body").css({ "background": colors[index] });
                if (uiLight[index]) {
                    if (!$("body").hasClass("light"))
                        $("body").addClass("light");
                } else {
                    if ($("body").hasClass("light"))
                        $("body").removeClass("light");
                }
            });
        }
        function changeLeatherColor(index) {

            
           
            if (leatherMaterial == null || loadedApi == null) {
                console.log("Api not loaded yet or failed.");
                return;
            }
            console.log(index);
            leatherMaterial.channels.AlbedoPBR.enable = true;
            leatherMaterial.channels.AlbedoPBR.factor = 1;
            leatherMaterial.channels.DiffuseColor.enable = false;

            console.log('change', intColors[index])
            const linearColor = srgbToLinear(hexToRgb(intColors[index]));
            leatherMaterial.channels.AlbedoPBR.color = linearColor;
            // leatherMaterial.channels.MetalnessPBR.factor = 0.5;
            loadedApi.setMaterial(leatherMaterial, function () {
                console.log('update leather material success')
            });
        }
        function changeIntColor1(index) {
            
            if (intMaterial1 == null || loadedApi == null) {
                console.log("Api not loaded yet or failed.");
                return;
            }
            const linearColor = srgbToLinear(hexToRgb(intColors[index]));
            intMaterial1.channels.AlbedoPBR.color = linearColor;
            loadedApi.setMaterial(intMaterial1, function () { });
        }
        function changeIntColor2(index) {
            if (intMaterial2 == null || loadedApi == null) {
                console.log("Api not loaded yet or failed.");
                return;
            }
            const linearColor = srgbToLinear(hexToRgb(intColors[index]));
            intMaterial2.channels.AlbedoPBR.color = linearColor;
            loadedApi.setMaterial(intMaterial2, function () { });
        }
        function changeIntColor3(index) {
             var colors = [
                "#8b7d70",
                "#1c1c1c",
                "#1c1c1c",
                "#606060",
                "#1c1c1c"
            ];
            if (intMaterial3 == null || loadedApi == null) {
                console.log("Api not loaded yet or failed.");
                return;
            }
            const linearColor = srgbToLinear(hexToRgb(colors[index]));
            intMaterial3.channels.AlbedoPBR.color = linearColor;
            loadedApi.setMaterial(intMaterial3, function () { });
        }
        function changeIntColor4(index) {
            var colors = [
                "#9d9d9d",
                "#aaaaaa",
                "#aaaaaa",
                "#aaaaaa",
                "#1c1c1c"
            ];
            if (intMaterial4 == null || loadedApi == null) {
                console.log("Api not loaded yet or failed.");
                return;
            }
            const linearColor = srgbToLinear(hexToRgb(colors[index]));
            intMaterial4.channels.AlbedoPBR.color = linearColor;
            loadedApi.setMaterial(intMaterial4, function () {
            });
        }
        function changeIntColor5(index) {
            var colors = [
                "#3c3c3c",
                "#3c3c3c",
                "#3c3c3c",
                "#3c3c3c",
                "#3c3c3c"
            ];
            if (intMaterial5 == null || loadedApi == null) {
                console.log("Api not loaded yet or failed.");
                return;
            }
            const linearColor = srgbToLinear(hexToRgb(colors[index]));
            intMaterial5.channels.AlbedoPBR.color = linearColor;
            loadedApi.setMaterial(intMaterial5, function () {
            });
        }
        function changeIntColor6(index) {
            var colors = [
                "#382f2b", // beige
                "#1c1c1c",
                "#1c1c1c",
                "#434343",
                "#1c1c1c"
            ];
            if (intMaterial6 == null || loadedApi == null) {
                console.log("Api not loaded yet or failed.");
                return;
            }
            const linearColor = srgbToLinear(hexToRgb(colors[index]));
            intMaterial6.channels.AlbedoPBR.color = linearColor;
            loadedApi.setMaterial(intMaterial6, function () {
            });
        }
        function changeIntColor7(index) {
            var colors = [
                "#8b7d70",
                "#1c1c1c",
                "#1c1c1c",
                "#606060",
                "#1c1c1c"
            ];
            if (intMaterial7 == null || loadedApi == null) {
                console.log("Api not loaded yet or failed.");
                return;
            }
            const linearColor = srgbToLinear(hexToRgb(colors[index]));
            intMaterial7.channels.AlbedoPBR.color = linearColor;
            loadedApi.setMaterial(intMaterial7, function () {
            });
        }

        function changeInterior(index) {
            changeLeatherColor(index);
        }

        function changeCamera(index, animate = false) {
            if (loadedApi == null) {
                console.log("Api not loaded yet or failed.");
                return;
            }
            loadedApi.setCameraEasing('easeLinear');
            if (index == 0) {
                loadedApi.lookat(
                    cameraPosition,
                    cameraTarget,
                    animate ? 1 : 0
                );
                loadedApi.setFov(40);
                if ($("#api-frame").hasClass("interior"))
                    $("#api-frame").removeClass("interior");
            } else if (index == 1) {
                loadedApi.lookat(
                    cameraHeadPosition,
                    cameraHeadTarget,
                    animate ? 1 : 0
                );
                loadedApi.setFov(60);
                if (!$("#api-frame").hasClass("interior"))
                    $("#api-frame").addClass("interior");
            } else if (index == 2) {
                loadedApi.lookat(
                    cameraHeadPosition2,
                    cameraHeadTarget2,
                    animate ? 1 : 0
                );
                loadedApi.setFov(60);
                if (!$("#api-frame").hasClass("interior"))
                    $("#api-frame").addClass("interior");
            }
        }
        var prcValue = 0;
        var nextprc = 10;
        setInterval(function () {
            if (prcValue < nextprc && prcValue < 100)
                prcValue += 1;
            document.getElementById("iframe-loader").innerHTML = "loading " + prcValue + "%<div style='width: " + prcValue + "%'></div>";
        }, 150);
        function loadmodel() {
            nextprc = 20;
            document.addEventListener('load', () => console.log('viewerready'));
            var client = new Sketchfab(iframe);

            client.init(urlid, {
                success: function onSuccess(api) {
                    console.log('Success');
                    loadedApi = api;
                    nextprc = 30;
                    api.load();
                    api.start();
                    nextprc = 80;


                    api.addEventListener('viewerready', function () {
                        nextprc = 99;
                        console.log('Viewer is ready');
                        let $apiFrame = document.getElementById("api-frame");
                        var frameMask = document.getElementById("iframe-mask");
                        var loader = document.getElementById("iframe-loader");
                        $apiFrame.classList.remove("iframe-hidden");

                        api.getAnimations(function (err, animations) {
                
                            api.setCurrentAnimationByUID(animations[0][0]);
                            api.setCycleMode('none');
                            api.pause();
                            api.seekTo(0);
                        });

                        api.setPostProcessing({
                            vignetteEnable: false
                        });

                        api.addEventListener('camerastop', function () {
                            api.getCameraLookAt(function (err, camera) {
                                var camTarget = camera.target;
                                switch (currentCamera) {
                                    case 0:
                                        if (camTarget[0] != cameraTarget[0] || camTarget[1] != cameraTarget[1] || camTarget[2] != cameraTarget[2])
                                            changeCamera(0, true);
                                        break;
                                    case 1:
                                        if (camTarget[0] != cameraHeadTarget[0] || camTarget[1] != cameraHeadTarget[1] || camTarget[2] != cameraHeadTarget[2])
                                            changeCamera(1, true);
                                        break;
                                    case 2:
                                        if (camTarget[0] != cameraHeadTarget2[0] || camTarget[1] != cameraHeadTarget2[1] || camTarget[2] != cameraHeadTarget2[2])
                                            changeCamera(2, true);
                                        break;
                                    default:
                                        console.log("Wrong camera index!");
                                        break;
                                }
                            });
                        });

                        api.getMaterialList(function (err, materials) {
							
						    paintMaterial = materials[25];
							leatherMaterial = materials[28];
                            api.getCameraLookAt(function (err, camera) {
                                changeCamera(0);
                                setTimeout(function () {
                                    nextprc = 100;
                                    changeCarColor(0);
                                    changeInterior(0);
                                    setTimeout(function () {
                                        prcValue = 100;
                                        document.getElementById("iframe-loader").innerHTML = "loading 100%<div style='width: 100%'></div>";
                                        frameMask.classList.add("hidden");
                                        loader.classList.add("hidden");
                                    }, 1000);
                                }, 1100);
                            });
                        });
                    });


                },
                error: function onError(callback) {
                    console.log(this.error);
                },
                graph_optimizer: 1,
                ui_animations: 0,
                ui_annotations: 0,
                ui_general_controls: 0,
                ui_watermark_link: 0,
                ui_watermark: 0,
                ui_infos: 0,
                ui_stop: 0,
                transparent: 1,
                camera: 0,
                scrollwheel: 1,
                preload: 1,
                double_click: 0,
				orbit_constraint_pitch_down: 0,
				orbit_constraint_zoom_in: 0,
				orbit_constraint_zoom_out: 1200
               
            });
        }

        $(document).ready(function(){
            loadmodel();
            currentColorText = $("#colorPicker .car-color.active").data("name");
           
            currentIntText = $("#colorPicker2 .int-color.active").data("name");
           
            $("#colorPicker span.info").text(currentColorText);
            $("#colorPicker2 span.info").text(currentIntText);
           
            $(".car-color").click(function(){
                var carColorIndex = $(this).data("color-id");
                $(".car-color").removeClass("active");
                $(this).addClass("active");
                currentColorText = $(this).data("name");
                
                changeCarColor(carColorIndex);
            });
            $(".car-color").hover(function(){
                var newText = $(this).data("name");
                
                $("#colorPicker span.info").text(newText);
            }, function(){
                $("#colorPicker span.info").text(currentColorText);
            });
            $(".int-color").click(function(){
                var intColorIndex = $(this).data("color-id");
                console.log('click change color', intColorIndex)
                $(".int-color").removeClass("active");
                $(this).addClass("active");
                currentIntText = $(this).data("name");
        
               
                changeInterior(intColorIndex);
            });
            $(".int-color").hover(function(){
                var newText = $(this).data("name");
                
                $("#colorPicker2 span.info").text(newText);
            }, function(){
                $("#colorPicker2 span.info").text(currentIntText);
            });
            $(".camera").click(function(){
                currentCamera = $(this).data("cam-id");
                console.log("Change camera " + currentCamera);
                changeCamera(currentCamera);
            });
            $(".selector-box span:first-child").click(function(){
                var btn = $(this);
                $(".selector-box .active").removeClass("active");
                setTimeout(function(){
                    btn.addClass("active");
                    if(btn.attr("id") == "colors" && !$("#colorPicker").hasClass("active")){
                        currentCamera = 0;
                        changeCamera(currentCamera);
                        $("#colorPicker").addClass("active");
                    } else if(btn.attr("id") != "colors" && $("#colorPicker").hasClass("active"))
                        $("#colorPicker").removeClass("active");
                    if(btn.attr("id") == "intColors" && !$("#colorPicker2").hasClass("active")){
                        currentCamera = 1;
                        changeCamera(currentCamera);
                        $("#colorPicker2").addClass("active");
                    } else if(btn.attr("id") != "intColors" && $("#colorPicker2").hasClass("active"))
                        $("#colorPicker2").removeClass("active");
                }, 300);
            });
            $("#openDoor").click(function () {
			 console.log("click open door "+animationRunning);
                if (animationRunning)
                    return;
                if (doorOpened) {
				console.log("doorOpened true");
				loadedApi.seekTo(8);
                    loadedApi.play();
                    doorOpened = false;
                    animationRunning = true;
                    animationInt = setInterval(function () {
                        loadedApi.getCurrentTime(function (err, time) {
                            if (time >= 10) {
                                loadedApi.pause();
                                clearInterval(animationInt);
                                animationRunning = false;
                            }
                        });
                    }, 10);
                } else {
				console.log("doorOpened false");
                    loadedApi.seekTo(0);
                    loadedApi.play();
                   
                    animationInt = setInterval(function () {
                        loadedApi.getCurrentTime(function (err, time) {
						
						if(time>1 && time<4)
						{
						 doorOpened = true;
						 animationRunning = true;
						}
						else
                            if (time >= 4) {
                                loadedApi.pause();
                                clearInterval(animationInt);
                                animationRunning = false;
                            }
                        });
                    }, 4);
                }
            });
        });
        
    </script>
</body>

</html>